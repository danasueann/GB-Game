                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (MINGW64)
                                      4 ;--------------------------------------------------------
                                      5 	.module main
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _main
                                     11 	.globl _keyboard_input_loop
                                     12 	.globl _choose_name
                                     13 	.globl _set_sprite_data
                                     14 	.globl _set_bkg_tiles
                                     15 	.globl _set_bkg_data
                                     16 	.globl _wait_vbl_done
                                     17 	.globl _joypad
                                     18 	.globl _selected_pet
                                     19 	.globl _setup_home_background
                                     20 	.globl _setup_select_menu_background
                                     21 	.globl _choose_pet
                                     22 	.globl _setup_cat
                                     23 	.globl _setup_cat_home
                                     24 	.globl _setup_jester
                                     25 	.globl _setup_jester_home
                                     26 	.globl _clear_background
                                     27 	.globl _clear_sprites
                                     28 ;--------------------------------------------------------
                                     29 ; special function registers
                                     30 ;--------------------------------------------------------
                                     31 ;--------------------------------------------------------
                                     32 ; ram data
                                     33 ;--------------------------------------------------------
                                     34 	.area _DATA
                                     35 ;--------------------------------------------------------
                                     36 ; ram data
                                     37 ;--------------------------------------------------------
                                     38 	.area _INITIALIZED
    00000000                         39 _selected_pet::
    00000000                         40 	.ds 1
                                     41 ;--------------------------------------------------------
                                     42 ; absolute external ram data
                                     43 ;--------------------------------------------------------
                                     44 	.area _DABS (ABS)
                                     45 ;--------------------------------------------------------
                                     46 ; global & static initialisations
                                     47 ;--------------------------------------------------------
                                     48 	.area _HOME
                                     49 	.area _GSINIT
                                     50 	.area _GSFINAL
                                     51 	.area _GSINIT
                                     52 ;--------------------------------------------------------
                                     53 ; Home
                                     54 ;--------------------------------------------------------
                                     55 	.area _HOME
                                     56 	.area _HOME
                                     57 ;--------------------------------------------------------
                                     58 ; code
                                     59 ;--------------------------------------------------------
                                     60 	.area _CODE
                                     61 ;home.h:12: void setup_home_background()
                                     62 ;	---------------------------------
                                     63 ; Function setup_home_background
                                     64 ; ---------------------------------
    00000000                         65 _setup_home_background::
                                     66 ;home.h:15: set_bkg_data(0, 216, background_final_tiles);
    00000000 11r00r00         [12]   67 	ld	de, #_background_final_tiles
    00000003 D5               [16]   68 	push	de
    00000004 21 00 D8         [12]   69 	ld	hl, #0xd800
    00000007 E5               [16]   70 	push	hl
    00000008 CDr00r00         [24]   71 	call	_set_bkg_data
    0000000B E8 04            [16]   72 	add	sp, #4
                                     73 ;home.h:16: set_bkg_tiles(0, 0, 20, 18, background_final_map);
    0000000D 11r00r00         [12]   74 	ld	de, #_background_final_map
    00000010 D5               [16]   75 	push	de
    00000011 21 14 12         [12]   76 	ld	hl, #0x1214
    00000014 E5               [16]   77 	push	hl
    00000015 AF               [ 4]   78 	xor	a, a
    00000016 0F               [ 4]   79 	rrca
    00000017 F5               [16]   80 	push	af
    00000018 CDr00r00         [24]   81 	call	_set_bkg_tiles
    0000001B E8 06            [16]   82 	add	sp, #6
                                     83 ;home.h:18: SHOW_BKG;
    0000001D F0r00            [12]   84 	ldh	a, (_LCDC_REG + 0)
    0000001F F6 01            [ 8]   85 	or	a, #0x01
    00000021 E0r00            [12]   86 	ldh	(_LCDC_REG + 0), a
                                     87 ;home.h:19: DISPLAY_ON;
    00000023 F0r00            [12]   88 	ldh	a, (_LCDC_REG + 0)
    00000025 F6 80            [ 8]   89 	or	a, #0x80
    00000027 E0r00            [12]   90 	ldh	(_LCDC_REG + 0), a
                                     91 ;home.h:20: }
    00000029 C9               [16]   92 	ret
                                     93 ;SelectMenu.h:13: void setup_select_menu_background()
                                     94 ;	---------------------------------
                                     95 ; Function setup_select_menu_background
                                     96 ; ---------------------------------
    0000002A                         97 _setup_select_menu_background::
                                     98 ;SelectMenu.h:16: set_bkg_data(0, 216, SelectMenu_tileset);
    0000002A 11r00r00         [12]   99 	ld	de, #_SelectMenu_tileset
    0000002D D5               [16]  100 	push	de
    0000002E 21 00 D8         [12]  101 	ld	hl, #0xd800
    00000031 E5               [16]  102 	push	hl
    00000032 CDr00r00         [24]  103 	call	_set_bkg_data
    00000035 E8 04            [16]  104 	add	sp, #4
                                    105 ;SelectMenu.h:17: set_bkg_tiles(0, 0, 20, 18, SelectMenu_tilemap);
    00000037 11r00r00         [12]  106 	ld	de, #_SelectMenu_tilemap
    0000003A D5               [16]  107 	push	de
    0000003B 21 14 12         [12]  108 	ld	hl, #0x1214
    0000003E E5               [16]  109 	push	hl
    0000003F AF               [ 4]  110 	xor	a, a
    00000040 0F               [ 4]  111 	rrca
    00000041 F5               [16]  112 	push	af
    00000042 CDr00r00         [24]  113 	call	_set_bkg_tiles
    00000045 E8 06            [16]  114 	add	sp, #6
                                    115 ;SelectMenu.h:19: SHOW_BKG;
    00000047 F0r00            [12]  116 	ldh	a, (_LCDC_REG + 0)
    00000049 F6 01            [ 8]  117 	or	a, #0x01
    0000004B E0r00            [12]  118 	ldh	(_LCDC_REG + 0), a
                                    119 ;SelectMenu.h:20: DISPLAY_ON;
    0000004D F0r00            [12]  120 	ldh	a, (_LCDC_REG + 0)
    0000004F F6 80            [ 8]  121 	or	a, #0x80
    00000051 E0r00            [12]  122 	ldh	(_LCDC_REG + 0), a
                                    123 ;SelectMenu.h:21: }
    00000053 C9               [16]  124 	ret
                                    125 ;SelectMenu.h:23: UBYTE choose_pet(void)
                                    126 ;	---------------------------------
                                    127 ; Function choose_pet
                                    128 ; ---------------------------------
    00000054                        129 _choose_pet::
                                    130 ;SelectMenu.h:25: while (1)
    00000054                        131 00107$:
                                    132 ;SelectMenu.h:27: UBYTE mButtons = joypad();
    00000054 CDr00r00         [24]  133 	call	_joypad
                                    134 ;SelectMenu.h:29: if (mButtons & J_A)
    00000057 CB 67            [ 8]  135 	bit	4, a
    00000059 28 02            [12]  136 	jr	Z, 00104$
                                    137 ;SelectMenu.h:31: return 0; // CAT selected
    0000005B AF               [ 4]  138 	xor	a, a
    0000005C C9               [16]  139 	ret
    0000005D                        140 00104$:
                                    141 ;SelectMenu.h:33: else if (mButtons & J_B)
    0000005D CB 6F            [ 8]  142 	bit	5, a
    0000005F 28 03            [12]  143 	jr	Z, 00105$
                                    144 ;SelectMenu.h:35: return 1; // JESTER selected
    00000061 3E 01            [ 8]  145 	ld	a, #0x01
    00000063 C9               [16]  146 	ret
    00000064                        147 00105$:
                                    148 ;SelectMenu.h:37: wait_vbl_done();
    00000064 CDr00r00         [24]  149 	call	_wait_vbl_done
                                    150 ;SelectMenu.h:39: }
    00000067 18 EB            [12]  151 	jr	00107$
                                    152 ;cat_animated.h:12: void setup_cat(int start_x, int start_y)
                                    153 ;	---------------------------------
                                    154 ; Function setup_cat
                                    155 ; ---------------------------------
    00000069                        156 _setup_cat::
    00000069 E8 F8            [16]  157 	add	sp, #-8
    0000006B F8 04            [12]  158 	ldhl	sp,	#4
    0000006D 7B               [ 4]  159 	ld	a, e
    0000006E 22               [ 8]  160 	ld	(hl+), a
    0000006F 72               [ 8]  161 	ld	(hl), d
    00000070 F8 02            [12]  162 	ldhl	sp,	#2
    00000072 79               [ 4]  163 	ld	a, c
    00000073 22               [ 8]  164 	ld	(hl+), a
    00000074 70               [ 8]  165 	ld	(hl), b
                                    166 ;cat_animated.h:15: set_sprite_data(0, cat_size, cat);
    00000075 11r00r00         [12]  167 	ld	de, #_cat
    00000078 D5               [16]  168 	push	de
    00000079 21 00 11         [12]  169 	ld	hl, #0x1100
    0000007C E5               [16]  170 	push	hl
    0000007D CDr00r00         [24]  171 	call	_set_sprite_data
    00000080 E8 04            [16]  172 	add	sp, #4
                                    173 ;cat_animated.h:17: for (int i = 0; i < cat_size; i++)
    00000082 F8 07            [12]  174 	ldhl	sp,	#7
    00000084 36 00            [12]  175 	ld	(hl), #0x00
    00000086                        176 00109$:
    00000086 F8 07            [12]  177 	ldhl	sp,	#7
    00000088 7E               [ 8]  178 	ld	a, (hl)
    00000089 D6 11            [ 8]  179 	sub	a, #0x11
    0000008B 30 21            [12]  180 	jr	NC, 00101$
                                    181 ;cat_animated.h:19: set_sprite_tile(i, cat_tilemap[i]);
    0000008D 11r00r00         [12]  182 	ld	de, #_cat_tilemap
    00000090 6E               [ 8]  183 	ld	l, (hl)
    00000091 26 00            [ 8]  184 	ld	h, #0x00
    00000093 19               [ 8]  185 	add	hl, de
    00000094 33               [ 8]  186 	inc	sp
    00000095 33               [ 8]  187 	inc	sp
    00000096 5D               [ 4]  188 	ld	e, l
    00000097 54               [ 4]  189 	ld	d, h
    00000098 D5               [16]  190 	push	de
    00000099 1A               [ 8]  191 	ld	a, (de)
    0000009A 4F               [ 4]  192 	ld	c, a
    0000009B F8 07            [12]  193 	ldhl	sp,	#7
                                    194 ;c:\gbdk\include\gb\gb.h:1887: shadow_OAM[nb].tile=tile;
    0000009D 6E               [ 8]  195 	ld	l, (hl)
    0000009E 11r00r00         [12]  196 	ld	de, #_shadow_OAM+0
    000000A1 26 00            [ 8]  197 	ld	h, #0x00
    000000A3 29               [ 8]  198 	add	hl, hl
    000000A4 29               [ 8]  199 	add	hl, hl
    000000A5 19               [ 8]  200 	add	hl, de
    000000A6 23               [ 8]  201 	inc	hl
    000000A7 23               [ 8]  202 	inc	hl
    000000A8 71               [ 8]  203 	ld	(hl), c
                                    204 ;cat_animated.h:17: for (int i = 0; i < cat_size; i++)
    000000A9 F8 07            [12]  205 	ldhl	sp,	#7
    000000AB 34               [12]  206 	inc	(hl)
    000000AC 18 D8            [12]  207 	jr	00109$
    000000AE                        208 00101$:
                                    209 ;cat_animated.h:24: int sprite_index = 0;
    000000AE 01 00 00         [12]  210 	ld	bc, #0x0000
                                    211 ;cat_animated.h:26: for (int row = 0; row < 4; row++)
    000000B1 F8 06            [12]  212 	ldhl	sp,	#6
    000000B3 36 00            [12]  213 	ld	(hl), #0x00
    000000B5                        214 00115$:
    000000B5 F8 06            [12]  215 	ldhl	sp,	#6
    000000B7 7E               [ 8]  216 	ld	a, (hl)
    000000B8 D6 04            [ 8]  217 	sub	a, #0x04
    000000BA 30 62            [12]  218 	jr	NC, 00105$
                                    219 ;cat_animated.h:28: for (int col = 0; col < 4; col++)
    000000BC 23               [ 8]  220 	inc	hl
    000000BD 36 00            [12]  221 	ld	(hl), #0x00
    000000BF                        222 00112$:
    000000BF F8 07            [12]  223 	ldhl	sp,	#7
    000000C1 7E               [ 8]  224 	ld	a, (hl)
    000000C2 D6 04            [ 8]  225 	sub	a, #0x04
    000000C4 30 53            [12]  226 	jr	NC, 00127$
                                    227 ;cat_animated.h:30: move_sprite(sprite_index, start_x + col * tile_width, start_y + row * tile_height);
    000000C6 F8 02            [12]  228 	ldhl	sp,	#2
    000000C8 3A               [ 8]  229 	ld	a, (hl-)
    000000C9 77               [ 8]  230 	ld	(hl), a
    000000CA F8 06            [12]  231 	ldhl	sp,	#6
    000000CC 7E               [ 8]  232 	ld	a, (hl)
    000000CD 87               [ 4]  233 	add	a, a
    000000CE 87               [ 4]  234 	add	a, a
    000000CF 87               [ 4]  235 	add	a, a
    000000D0 F8 01            [12]  236 	ldhl	sp,	#1
    000000D2 86               [ 8]  237 	add	a, (hl)
    000000D3 2B               [ 8]  238 	dec	hl
    000000D4 77               [ 8]  239 	ld	(hl), a
    000000D5 F8 04            [12]  240 	ldhl	sp,	#4
    000000D7 7E               [ 8]  241 	ld	a, (hl)
    000000D8 F8 01            [12]  242 	ldhl	sp,	#1
    000000DA 77               [ 8]  243 	ld	(hl), a
    000000DB F8 07            [12]  244 	ldhl	sp,	#7
    000000DD 7E               [ 8]  245 	ld	a, (hl)
    000000DE 87               [ 4]  246 	add	a, a
    000000DF 87               [ 4]  247 	add	a, a
    000000E0 87               [ 4]  248 	add	a, a
    000000E1 F8 01            [12]  249 	ldhl	sp,	#1
    000000E3 86               [ 8]  250 	add	a, (hl)
    000000E4 77               [ 8]  251 	ld	(hl), a
    000000E5 59               [ 4]  252 	ld	e, c
                                    253 ;c:\gbdk\include\gb\gb.h:1973: OAM_item_t * itm = &shadow_OAM[nb];
    000000E6 AF               [ 4]  254 	xor	a, a
    000000E7 6B               [ 4]  255 	ld	l, e
    000000E8 67               [ 4]  256 	ld	h, a
    000000E9 29               [ 8]  257 	add	hl, hl
    000000EA 29               [ 8]  258 	add	hl, hl
    000000EB 11r00r00         [12]  259 	ld	de, #_shadow_OAM
    000000EE 19               [ 8]  260 	add	hl, de
    000000EF 5D               [ 4]  261 	ld	e, l
    000000F0 54               [ 4]  262 	ld	d, h
                                    263 ;c:\gbdk\include\gb\gb.h:1974: itm->y=y, itm->x=x;
    000000F1 F8 00            [12]  264 	ldhl	sp,	#0
    000000F3 2A               [ 8]  265 	ld	a, (hl+)
    000000F4 12               [ 8]  266 	ld	(de), a
    000000F5 13               [ 8]  267 	inc	de
    000000F6 7E               [ 8]  268 	ld	a, (hl)
    000000F7 12               [ 8]  269 	ld	(de), a
                                    270 ;cat_animated.h:31: sprite_index++;
    000000F8 03               [ 8]  271 	inc	bc
                                    272 ;cat_animated.h:32: if (sprite_index > 15)
    000000F9 58               [ 4]  273 	ld	e, b
    000000FA 16 00            [ 8]  274 	ld	d, #0x00
    000000FC 3E 0F            [ 8]  275 	ld	a, #0x0f
    000000FE B9               [ 4]  276 	cp	a, c
    000000FF 3E 00            [ 8]  277 	ld	a, #0x00
    00000101 98               [ 4]  278 	sbc	a, b
    00000102 CB 7B            [ 8]  279 	bit	7, e
    00000104 28 07            [12]  280 	jr	Z, 00171$
    00000106 CB 7A            [ 8]  281 	bit	7, d
    00000108 20 08            [12]  282 	jr	NZ, 00172$
    0000010A BF               [ 4]  283 	cp	a, a
    0000010B 18 05            [12]  284 	jr	00172$
    0000010D                        285 00171$:
    0000010D CB 7A            [ 8]  286 	bit	7, d
    0000010F 28 01            [12]  287 	jr	Z, 00172$
    00000111 37               [ 4]  288 	scf
    00000112                        289 00172$:
    00000112 38 05            [12]  290 	jr	C, 00127$
                                    291 ;cat_animated.h:28: for (int col = 0; col < 4; col++)
    00000114 F8 07            [12]  292 	ldhl	sp,	#7
    00000116 34               [12]  293 	inc	(hl)
    00000117 18 A6            [12]  294 	jr	00112$
    00000119                        295 00127$:
                                    296 ;cat_animated.h:26: for (int row = 0; row < 4; row++)
    00000119 F8 06            [12]  297 	ldhl	sp,	#6
    0000011B 34               [12]  298 	inc	(hl)
    0000011C 18 97            [12]  299 	jr	00115$
    0000011E                        300 00105$:
                                    301 ;cat_animated.h:37: SHOW_SPRITES; // Show the sprites on the screen
    0000011E F0r00            [12]  302 	ldh	a, (_LCDC_REG + 0)
    00000120 F6 02            [ 8]  303 	or	a, #0x02
    00000122 E0r00            [12]  304 	ldh	(_LCDC_REG + 0), a
                                    305 ;cat_animated.h:38: }
    00000124 E8 08            [16]  306 	add	sp, #8
    00000126 C9               [16]  307 	ret
                                    308 ;cat_animated.h:40: void setup_cat_home()
                                    309 ;	---------------------------------
                                    310 ; Function setup_cat_home
                                    311 ; ---------------------------------
    00000127                        312 _setup_cat_home::
                                    313 ;cat_animated.h:42: setup_cat(100, 100);
    00000127 01 64 00         [12]  314 	ld	bc, #0x0064
    0000012A 50               [ 4]  315 	ld	d, b
    0000012B 59               [ 4]  316 	ld	e, c
                                    317 ;cat_animated.h:43: }
    0000012C C3r69r00         [16]  318 	jp	_setup_cat
                                    319 ;jester.h:12: void setup_jester(int start_x, int start_y)
                                    320 ;	---------------------------------
                                    321 ; Function setup_jester
                                    322 ; ---------------------------------
    0000012F                        323 _setup_jester::
    0000012F E8 F8            [16]  324 	add	sp, #-8
    00000131 F8 04            [12]  325 	ldhl	sp,	#4
    00000133 7B               [ 4]  326 	ld	a, e
    00000134 22               [ 8]  327 	ld	(hl+), a
    00000135 72               [ 8]  328 	ld	(hl), d
    00000136 F8 02            [12]  329 	ldhl	sp,	#2
    00000138 79               [ 4]  330 	ld	a, c
    00000139 22               [ 8]  331 	ld	(hl+), a
    0000013A 70               [ 8]  332 	ld	(hl), b
                                    333 ;jester.h:15: set_sprite_data(32, jester_size, jester);
    0000013B 11r00r00         [12]  334 	ld	de, #_jester
    0000013E D5               [16]  335 	push	de
    0000013F 21 20 10         [12]  336 	ld	hl, #0x1020
    00000142 E5               [16]  337 	push	hl
    00000143 CDr00r00         [24]  338 	call	_set_sprite_data
    00000146 E8 04            [16]  339 	add	sp, #4
                                    340 ;jester.h:17: for (int i = 0; i < jester_size; i++)
    00000148 F8 07            [12]  341 	ldhl	sp,	#7
    0000014A 36 00            [12]  342 	ld	(hl), #0x00
    0000014C                        343 00109$:
    0000014C F8 07            [12]  344 	ldhl	sp,	#7
    0000014E 7E               [ 8]  345 	ld	a, (hl)
    0000014F D6 10            [ 8]  346 	sub	a, #0x10
    00000151 30 27            [12]  347 	jr	NC, 00101$
                                    348 ;jester.h:19: set_sprite_tile(i+16, jester_tilemap[i] + 32);
    00000153 11r00r00         [12]  349 	ld	de, #_jester_tilemap
    00000156 6E               [ 8]  350 	ld	l, (hl)
    00000157 26 00            [ 8]  351 	ld	h, #0x00
    00000159 19               [ 8]  352 	add	hl, de
    0000015A 33               [ 8]  353 	inc	sp
    0000015B 33               [ 8]  354 	inc	sp
    0000015C 5D               [ 4]  355 	ld	e, l
    0000015D 54               [ 4]  356 	ld	d, h
    0000015E D5               [16]  357 	push	de
    0000015F 1A               [ 8]  358 	ld	a, (de)
    00000160 C6 20            [ 8]  359 	add	a, #0x20
    00000162 4F               [ 4]  360 	ld	c, a
    00000163 F8 07            [12]  361 	ldhl	sp,	#7
    00000165 7E               [ 8]  362 	ld	a, (hl)
    00000166 C6 10            [ 8]  363 	add	a, #0x10
    00000168 5F               [ 4]  364 	ld	e, a
                                    365 ;c:\gbdk\include\gb\gb.h:1887: shadow_OAM[nb].tile=tile;
    00000169 AF               [ 4]  366 	xor	a, a
    0000016A 6B               [ 4]  367 	ld	l, e
    0000016B 67               [ 4]  368 	ld	h, a
    0000016C 29               [ 8]  369 	add	hl, hl
    0000016D 29               [ 8]  370 	add	hl, hl
    0000016E 11r00r00         [12]  371 	ld	de, #_shadow_OAM
    00000171 19               [ 8]  372 	add	hl, de
    00000172 23               [ 8]  373 	inc	hl
    00000173 23               [ 8]  374 	inc	hl
    00000174 71               [ 8]  375 	ld	(hl), c
                                    376 ;jester.h:17: for (int i = 0; i < jester_size; i++)
    00000175 F8 07            [12]  377 	ldhl	sp,	#7
    00000177 34               [12]  378 	inc	(hl)
    00000178 18 D2            [12]  379 	jr	00109$
    0000017A                        380 00101$:
                                    381 ;jester.h:24: int sprite_index = 16;
    0000017A 01 10 00         [12]  382 	ld	bc, #0x0010
                                    383 ;jester.h:26: for (int row = 0; row < 4; row++)
    0000017D F8 06            [12]  384 	ldhl	sp,	#6
    0000017F 36 00            [12]  385 	ld	(hl), #0x00
    00000181                        386 00115$:
    00000181 F8 06            [12]  387 	ldhl	sp,	#6
    00000183 7E               [ 8]  388 	ld	a, (hl)
    00000184 D6 04            [ 8]  389 	sub	a, #0x04
    00000186 30 62            [12]  390 	jr	NC, 00105$
                                    391 ;jester.h:28: for (int col = 0; col < 4; col++)
    00000188 23               [ 8]  392 	inc	hl
    00000189 36 00            [12]  393 	ld	(hl), #0x00
    0000018B                        394 00112$:
    0000018B F8 07            [12]  395 	ldhl	sp,	#7
    0000018D 7E               [ 8]  396 	ld	a, (hl)
    0000018E D6 04            [ 8]  397 	sub	a, #0x04
    00000190 30 53            [12]  398 	jr	NC, 00127$
                                    399 ;jester.h:30: move_sprite(sprite_index, start_x + col * tile_width, start_y + row * tile_height);
    00000192 F8 02            [12]  400 	ldhl	sp,	#2
    00000194 3A               [ 8]  401 	ld	a, (hl-)
    00000195 77               [ 8]  402 	ld	(hl), a
    00000196 F8 06            [12]  403 	ldhl	sp,	#6
    00000198 7E               [ 8]  404 	ld	a, (hl)
    00000199 87               [ 4]  405 	add	a, a
    0000019A 87               [ 4]  406 	add	a, a
    0000019B 87               [ 4]  407 	add	a, a
    0000019C F8 01            [12]  408 	ldhl	sp,	#1
    0000019E 86               [ 8]  409 	add	a, (hl)
    0000019F 2B               [ 8]  410 	dec	hl
    000001A0 77               [ 8]  411 	ld	(hl), a
    000001A1 F8 04            [12]  412 	ldhl	sp,	#4
    000001A3 7E               [ 8]  413 	ld	a, (hl)
    000001A4 F8 01            [12]  414 	ldhl	sp,	#1
    000001A6 77               [ 8]  415 	ld	(hl), a
    000001A7 F8 07            [12]  416 	ldhl	sp,	#7
    000001A9 7E               [ 8]  417 	ld	a, (hl)
    000001AA 87               [ 4]  418 	add	a, a
    000001AB 87               [ 4]  419 	add	a, a
    000001AC 87               [ 4]  420 	add	a, a
    000001AD F8 01            [12]  421 	ldhl	sp,	#1
    000001AF 86               [ 8]  422 	add	a, (hl)
    000001B0 77               [ 8]  423 	ld	(hl), a
    000001B1 59               [ 4]  424 	ld	e, c
                                    425 ;c:\gbdk\include\gb\gb.h:1973: OAM_item_t * itm = &shadow_OAM[nb];
    000001B2 AF               [ 4]  426 	xor	a, a
    000001B3 6B               [ 4]  427 	ld	l, e
    000001B4 67               [ 4]  428 	ld	h, a
    000001B5 29               [ 8]  429 	add	hl, hl
    000001B6 29               [ 8]  430 	add	hl, hl
    000001B7 11r00r00         [12]  431 	ld	de, #_shadow_OAM
    000001BA 19               [ 8]  432 	add	hl, de
    000001BB 5D               [ 4]  433 	ld	e, l
    000001BC 54               [ 4]  434 	ld	d, h
                                    435 ;c:\gbdk\include\gb\gb.h:1974: itm->y=y, itm->x=x;
    000001BD F8 00            [12]  436 	ldhl	sp,	#0
    000001BF 2A               [ 8]  437 	ld	a, (hl+)
    000001C0 12               [ 8]  438 	ld	(de), a
    000001C1 13               [ 8]  439 	inc	de
    000001C2 7E               [ 8]  440 	ld	a, (hl)
    000001C3 12               [ 8]  441 	ld	(de), a
                                    442 ;jester.h:31: sprite_index++;
    000001C4 03               [ 8]  443 	inc	bc
                                    444 ;jester.h:32: if (sprite_index > 31) // Adjusted to 31 since we have 16 sprites and start from 16
    000001C5 58               [ 4]  445 	ld	e, b
    000001C6 16 00            [ 8]  446 	ld	d, #0x00
    000001C8 3E 1F            [ 8]  447 	ld	a, #0x1f
    000001CA B9               [ 4]  448 	cp	a, c
    000001CB 3E 00            [ 8]  449 	ld	a, #0x00
    000001CD 98               [ 4]  450 	sbc	a, b
    000001CE CB 7B            [ 8]  451 	bit	7, e
    000001D0 28 07            [12]  452 	jr	Z, 00171$
    000001D2 CB 7A            [ 8]  453 	bit	7, d
    000001D4 20 08            [12]  454 	jr	NZ, 00172$
    000001D6 BF               [ 4]  455 	cp	a, a
    000001D7 18 05            [12]  456 	jr	00172$
    000001D9                        457 00171$:
    000001D9 CB 7A            [ 8]  458 	bit	7, d
    000001DB 28 01            [12]  459 	jr	Z, 00172$
    000001DD 37               [ 4]  460 	scf
    000001DE                        461 00172$:
    000001DE 38 05            [12]  462 	jr	C, 00127$
                                    463 ;jester.h:28: for (int col = 0; col < 4; col++)
    000001E0 F8 07            [12]  464 	ldhl	sp,	#7
    000001E2 34               [12]  465 	inc	(hl)
    000001E3 18 A6            [12]  466 	jr	00112$
    000001E5                        467 00127$:
                                    468 ;jester.h:26: for (int row = 0; row < 4; row++)
    000001E5 F8 06            [12]  469 	ldhl	sp,	#6
    000001E7 34               [12]  470 	inc	(hl)
    000001E8 18 97            [12]  471 	jr	00115$
    000001EA                        472 00105$:
                                    473 ;jester.h:37: SHOW_SPRITES; // Show the sprites on the screen
    000001EA F0r00            [12]  474 	ldh	a, (_LCDC_REG + 0)
    000001EC F6 02            [ 8]  475 	or	a, #0x02
    000001EE E0r00            [12]  476 	ldh	(_LCDC_REG + 0), a
                                    477 ;jester.h:38: }
    000001F0 E8 08            [16]  478 	add	sp, #8
    000001F2 C9               [16]  479 	ret
                                    480 ;jester.h:40: void setup_jester_home()
                                    481 ;	---------------------------------
                                    482 ; Function setup_jester_home
                                    483 ; ---------------------------------
    000001F3                        484 _setup_jester_home::
                                    485 ;jester.h:42: setup_jester(100, 100);
    000001F3 01 64 00         [12]  486 	ld	bc, #0x0064
    000001F6 50               [ 4]  487 	ld	d, b
    000001F7 59               [ 4]  488 	ld	e, c
                                    489 ;jester.h:43: }
    000001F8 C3r2Fr01         [16]  490 	jp	_setup_jester
                                    491 ;main.c:18: void main()
                                    492 ;	---------------------------------
                                    493 ; Function main
                                    494 ; ---------------------------------
    000001FB                        495 _main::
                                    496 ;main.c:20: DISPLAY_ON;
    000001FB F0r00            [12]  497 	ldh	a, (_LCDC_REG + 0)
    000001FD F6 80            [ 8]  498 	or	a, #0x80
    000001FF E0r00            [12]  499 	ldh	(_LCDC_REG + 0), a
                                    500 ;main.c:22: setup_select_menu_background();
    00000201 CDr2Ar00         [24]  501 	call	_setup_select_menu_background
                                    502 ;main.c:24: setup_cat(32, 80);     // Set up the cat sprite at position (32, 80)
    00000204 01 50 00         [12]  503 	ld	bc, #0x0050
    00000207 11 20 00         [12]  504 	ld	de, #0x0020
    0000020A CDr69r00         [24]  505 	call	_setup_cat
                                    506 ;main.c:25: setup_jester(110, 80); // Set up the jester sprite at position (110, 80)
    0000020D 01 50 00         [12]  507 	ld	bc, #0x0050
    00000210 11 6E 00         [12]  508 	ld	de, #0x006e
    00000213 CDr2Fr01         [24]  509 	call	_setup_jester
                                    510 ;main.c:27: selected_pet = choose_pet();
    00000216 CDr54r00         [24]  511 	call	_choose_pet
    00000219 EAr00r00         [16]  512 	ld	(#_selected_pet),a
                                    513 ;main.c:28: clear_background();
    0000021C CDr51r02         [24]  514 	call	_clear_background
                                    515 ;main.c:29: clear_sprites();
    0000021F CDr68r02         [24]  516 	call	_clear_sprites
                                    517 ;main.c:32: choose_name();
    00000222 CDr00r00         [24]  518 	call	_choose_name
                                    519 ;main.c:33: keyboard_input_loop(); // This replaces the while loop from the original code
    00000225 CDr00r00         [24]  520 	call	_keyboard_input_loop
                                    521 ;main.c:35: if (pet_has_name)
    00000228 FAr00r00         [16]  522 	ld	a, (#_pet_has_name)
    0000022B B7               [ 4]  523 	or	a, a
    0000022C 28 0C            [12]  524 	jr	Z, 00102$
                                    525 ;c:\gbdk\include\gb\gb.h:1475: SCX_REG+=x, SCY_REG+=y;
    0000022E F0r00            [12]  526 	ldh	a, (_SCX_REG + 0)
    00000230 C6 04            [ 8]  527 	add	a, #0x04
    00000232 E0r00            [12]  528 	ldh	(_SCX_REG + 0), a
                                    529 ;main.c:38: clear_background();
    00000234 CDr51r02         [24]  530 	call	_clear_background
                                    531 ;main.c:39: clear_sprites();
    00000237 CDr68r02         [24]  532 	call	_clear_sprites
    0000023A                        533 00102$:
                                    534 ;main.c:42: if (selected_pet == 0)
    0000023A FAr00r00         [16]  535 	ld	a, (#_selected_pet)
    0000023D B7               [ 4]  536 	or	a, a
    0000023E 20 06            [12]  537 	jr	NZ, 00106$
                                    538 ;main.c:44: setup_home_background();
    00000240 CDr00r00         [24]  539 	call	_setup_home_background
                                    540 ;main.c:45: setup_cat_home();
    00000243 C3r27r01         [16]  541 	jp	_setup_cat_home
    00000246                        542 00106$:
                                    543 ;main.c:47: else if (selected_pet == 1)
    00000246 FAr00r00         [16]  544 	ld	a, (#_selected_pet)
    00000249 3D               [ 4]  545 	dec	a
    0000024A C0               [20]  546 	ret	NZ
                                    547 ;main.c:49: setup_home_background();
    0000024B CDr00r00         [24]  548 	call	_setup_home_background
                                    549 ;main.c:50: setup_jester_home();
                                    550 ;main.c:52: }
    0000024E C3rF3r01         [16]  551 	jp	_setup_jester_home
                                    552 ;main.c:54: void clear_background()
                                    553 ;	---------------------------------
                                    554 ; Function clear_background
                                    555 ; ---------------------------------
    00000251                        556 _clear_background::
                                    557 ;main.c:56: set_bkg_tiles(0, 0, 20, 18, background_final_map);
    00000251 11r00r00         [12]  558 	ld	de, #_background_final_map
    00000254 D5               [16]  559 	push	de
    00000255 21 14 12         [12]  560 	ld	hl, #0x1214
    00000258 E5               [16]  561 	push	hl
    00000259 AF               [ 4]  562 	xor	a, a
    0000025A 0F               [ 4]  563 	rrca
    0000025B F5               [16]  564 	push	af
    0000025C CDr00r00         [24]  565 	call	_set_bkg_tiles
    0000025F E8 06            [16]  566 	add	sp, #6
                                    567 ;main.c:57: SHOW_BKG;
    00000261 F0r00            [12]  568 	ldh	a, (_LCDC_REG + 0)
    00000263 F6 01            [ 8]  569 	or	a, #0x01
    00000265 E0r00            [12]  570 	ldh	(_LCDC_REG + 0), a
                                    571 ;main.c:58: }
    00000267 C9               [16]  572 	ret
                                    573 ;main.c:60: void clear_sprites()
                                    574 ;	---------------------------------
                                    575 ; Function clear_sprites
                                    576 ; ---------------------------------
    00000268                        577 _clear_sprites::
                                    578 ;main.c:62: for (UBYTE i = 1; i < 32; i++)
    00000268 0E 01            [ 8]  579 	ld	c, #0x01
    0000026A                        580 00105$:
    0000026A 79               [ 4]  581 	ld	a, c
    0000026B D6 20            [ 8]  582 	sub	a, #0x20
    0000026D 30 18            [12]  583 	jr	NC, 00101$
                                    584 ;c:\gbdk\include\gb\gb.h:1973: OAM_item_t * itm = &shadow_OAM[nb];
    0000026F 69               [ 4]  585 	ld	l, c
    00000270 26 00            [ 8]  586 	ld	h, #0x00
    00000272 29               [ 8]  587 	add	hl, hl
    00000273 29               [ 8]  588 	add	hl, hl
    00000274 5D               [ 4]  589 	ld	e, l
    00000275 54               [ 4]  590 	ld	d, h
    00000276 21r00r00         [12]  591 	ld	hl, #_shadow_OAM
    00000279 19               [ 8]  592 	add	hl, de
                                    593 ;c:\gbdk\include\gb\gb.h:1974: itm->y=y, itm->x=x;
    0000027A AF               [ 4]  594 	xor	a, a
    0000027B 22               [ 8]  595 	ld	(hl+), a
    0000027C 77               [ 8]  596 	ld	(hl), a
                                    597 ;c:\gbdk\include\gb\gb.h:1887: shadow_OAM[nb].tile=tile;
    0000027D 21r01r00         [12]  598 	ld	hl,#_shadow_OAM + 1
    00000280 19               [ 8]  599 	add	hl,de
    00000281 23               [ 8]  600 	inc	hl
    00000282 36 00            [12]  601 	ld	(hl), #0x00
                                    602 ;main.c:62: for (UBYTE i = 1; i < 32; i++)
    00000284 0C               [ 4]  603 	inc	c
    00000285 18 E3            [12]  604 	jr	00105$
    00000287                        605 00101$:
                                    606 ;main.c:67: HIDE_SPRITES;
    00000287 F0r00            [12]  607 	ldh	a, (_LCDC_REG + 0)
    00000289 E6 FD            [ 8]  608 	and	a, #0xfd
    0000028B E0r00            [12]  609 	ldh	(_LCDC_REG + 0), a
                                    610 ;main.c:68: }
    0000028D C9               [16]  611 	ret
                                    612 	.area _CODE
                                    613 	.area _INITIALIZER
    00000000                        614 __xinit__selected_pet:
    00000000 00                     615 	.db #0x00	; 0
                                    616 	.area _CABS (ABS)
